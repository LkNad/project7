<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Аналитика недвижимости</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="container">
        <h1>Аналитика рынка недвижимости</h1>

        <!-- Панель фильтров -->
        <div class="filter-panel">
            <h3>Фильтры</h3>
            <form method="POST">
                <div class="filter-group">
                    <label>Диапазон цен:</label>
                    <input type="number" name="price_min" placeholder="От" value="{{ current_filters.price_range[0] }}">
                    <input type="number" name="price_max" placeholder="До" value="{{ current_filters.price_range[1] }}">
                </div>

                <div class="filter-group">
                    <label>Количество комнат:</label>
                    <select name="rooms">
                        <option value="">Любое</option>
                        <option value="1" {% if current_filters.rooms == 1 %}selected{% endif %}>1</option>
                        <option value="2" {% if current_filters.rooms == 2 %}selected{% endif %}>2</option>
                        <option value="3" {% if current_filters.rooms == 3 %}selected{% endif %}>3</option>
                        <option value="4" {% if current_filters.rooms == 4 %}selected{% endif %}>4+</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label>Район:</label>
                    <select name="district">
                        <option value="">Любой</option>
                        <option value="Центральный" {% if current_filters.district == 'Центральный' %}selected{% endif %}>Центральный</option>
                        <option value="Северный" {% if current_filters.district == 'Северный' %}selected{% endif %}>Северный</option>
                        <option value="Южный" {% if current_filters.district == 'Южный' %}selected{% endif %}>Южный</option>
                        <option value="Западный" {% if current_filters.district == 'Западный' %}selected{% endif %}>Западный</option>
                        <option value="Восточный" {% if current_filters.district == 'Восточный' %}selected{% endif %}>Восточный</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label>Тип диаграммы:</label>
                    <select name="chart_type">
                        <option value="bar" {% if current_filters.chart_type == 'bar' %}selected{% endif %}>Столбчатая</option>
                        <option value="pie" {% if current_filters.chart_type == 'pie' %}selected{% endif %}>Круговая</option>
                        <option value="line" {% if current_filters.chart_type == 'line' %}selected{% endif %}>Линейная</option>
                        <option value="table" {% if current_filters.chart_type == 'table' %}selected{% endif %}>Таблица</option>
                    </select>
                </div>

                <div class="filter-buttons">
                    <button type="submit" name="action" value="apply_filters" class="btn-apply">Применить фильтры</button>
                    <button type="submit" name="action" value="reset_filters" class="btn-reset">Сбросить фильтры</button>
                </div>
            </form>
        </div>

        <!-- Блок результатов -->
        <div class="results-info">
            <span>Найдено объявлений: {{ results_count }}</span>
        </div>

        <!-- Визуализации -->
        <div class="visualizations">
            <div class="chart-section">
                {{ chart_html|safe }}
            </div>

            <div class="map-section">
                {{ map_html|safe }}
            </div>
        </div>
    </div>
</body>
</html>
